# Traceability Matrix

This document maps each functional requirement (FR) defined in `functional_requirements.md` to the repositories, files, and modules that implement it. Updating this matrix is part of the **Doc Sync Checklist** defined in `.system/DOC_SYNC_CHECKLIST.md`.

| FR ID | Repository & Location | Implementation Notes | Test Location (planned) |
|------|----------------------|----------------------|-------------------------|
| **FR-001** | **FE:** `types.ts` (Task, TaskStatus, TaskPriority, Comment), `views/TasksIndex.tsx`, `components/CreateTaskModal.tsx`, `components/TaskDetailModal.tsx`, `services/dataService.ts` (getTasks, addTask, updateTask) | Kanban board grouped by status. In-memory CRUD in Phase 0. Backend will persist via `tasks.*` IPC commands. | `frontend/tests/tasks.spec.tsx`, `backend/tests/tasks.rs` |
| **FR-002** | **FE:** `types.ts` (Project, ProjectTemplate), `views/ProjectsIndex.tsx`, `views/ProjectDetail.tsx`, `services/dataService.ts` (getProjects, createProject, updateProject) | Gallery + detail views. Template-based creation. Milestones in-memory. Artifacts via AI image gen. | `frontend/tests/projects.spec.tsx`, `backend/tests/projects.rs` |
| **FR-003** | **FE:** `types.ts` (Note, FileNode), `views/NotesLibrary.tsx`, `services/dataService.ts` (getVaultRoot, getFileContent) | Two-panel file tree + note viewer. Mock `MOCK_FILE_SYSTEM` in constants.ts. | `frontend/tests/notes.spec.tsx`, `backend/tests/notes.rs` |
| **FR-004** | **FE:** `views/TodayDashboard.tsx`, `services/dataService.ts` (getTasks, getTodaySchedule, getHabits, saveQuickCapture) | Composite widget view. Queries tasks, schedule, habits. Quick capture appends to vault. | `frontend/tests/dashboard.spec.tsx`, `backend/tests/calendar.rs` |
| **FR-005** | **FE:** `components/CommandPalette.tsx`, `App.tsx` (keyboard handlers), `services/dataService.ts` (searchGlobal) | Cmd+K opens palette. Searches across file names, task titles, project titles. | `frontend/tests/command_palette.spec.tsx` |
| **FR-006** | **FE:** `types.ts` (FeatureFlags), `App.tsx` (AppState.features), `components/LeftNav.tsx`, `views/Settings.tsx` | 7 toggleable modules. Default: Workouts OFF, rest ON. Settings UI toggles. | `frontend/tests/settings.spec.tsx` |
| **FR-007** | **FE:** `views/ProjectDetail.tsx` (milestones, embedded task board, artifacts), `components/RightDrawer.tsx` (note/project/task detail panels) | Project detail shows filtered task kanban + milestone checklist. Notes show AI summary in drawer. | `frontend/tests/detail_views.spec.tsx` |
| **FR-008** | **FE:** `types.ts` (Trip), `views/Travel.tsx`, `services/dataService.ts` (getTripsFromVault, createTripFolder, createTripCard) | Vault-backed trips: folder per trip, Overview.md for metadata, child .md files as cards. | `frontend/tests/travel.spec.tsx`, `backend/tests/trips.rs` |
| **FR-009** | **FE:** `types.ts` (Transaction, ManualAccount, YNABBudgetMonth), `views/Finance.tsx`, `services/dataService.ts` (getManualAccounts, addManualAccount, getYnabTransactions, getYnabBudgetMonths, simulateCsvUpload) | Tabbed finance view with budget charts (Recharts), transaction table, manual accounts, CSV import. | `frontend/tests/finance.spec.tsx`, `backend/tests/finance.rs` |
| **FR-010** | **FE:** `types.ts` (JournalEntry), `views/Journal.tsx`, `services/dataService.ts` (getJournalEntries, addJournalEntry). **ADR:** ADR-0003 | Reverse-chronological feed with mood selector. Not in original vision; dedicated module with structured mood tracking. | `frontend/tests/journal.spec.tsx`, `backend/tests/journal.rs` |
| **FR-011** | **FE:** `types.ts` (Habit), `views/Habits.tsx`, `services/dataService.ts` (getHabits, addHabit, toggleHabit) | Habit list with streak counters and daily toggle. CompletedDates array tracks history. | `frontend/tests/habits.spec.tsx`, `backend/tests/habits.rs` |
| **FR-012** | **FE:** `types.ts` (Goal), `views/Goals.tsx`, `services/dataService.ts` (getGoals, addGoal, updateGoal). **ADR:** ADR-0001 | Goal cards with progress bars. Types: Monthly, Yearly, Long-Term. Optional project link. Not in original vision. | `frontend/tests/goals.spec.tsx`, `backend/tests/goals.rs` |
| **FR-013** | **FE:** `types.ts` (Meal, Recipe), `views/Meals.tsx`. **ADR:** ADR-0002 | Type definitions exist. View renders meal log + recipe library. **Gap:** DataService functions are in-view only (no exported service functions yet) — Meals is the only module with this pattern. Before Phase 1 IPC wiring, CRUD must be extracted to `dataService.ts` to match other modules. Not in original vision. | `frontend/tests/meals.spec.tsx`, `backend/tests/meals.rs` |
| **FR-014** | **FE:** `types.ts` (AIModel, AISettings, AgentAction, AIProvider), `services/aiService.ts` (sendChatMessage, generateNoteSummary, generateImageArtifact, validateApiKey), `components/RightDrawer.tsx` (AI chat panel), `views/Settings.tsx` (AI config). **ADR:** ADR-0004, ADR-0005 | Phase 0: Direct Gemini calls from frontend. OpenAI/Claude mocked. Agent tools: addTask, addGoal, addJournalEntry, searchBrain execute without HITL. Image gen for project artifacts. Phase 4: moves to Rust backend. | `frontend/tests/ai.spec.tsx`, `backend/tests/ai.rs` |
| **FR-015** | **FE:** `types.ts` (CalendarEvent), `views/WeekDashboard.tsx`, `services/dataService.ts` (getWeekEvents, addCalendarEvent, updateCalendarEvent, deleteCalendarEvent) | 7-column week grid. Event types: event, task, deep-work, reminder. Drag interactions. | `frontend/tests/calendar.spec.tsx`, `backend/tests/calendar.rs` |
| **FR-016** | **FE:** `App.tsx` (theme useEffect), `views/Settings.tsx` | Adds/removes `light` class on `<html>`. CSS custom properties define palette. | `frontend/tests/theme.spec.tsx` |
| **FR-017** | **FE:** `components/LeftNav.tsx`, `components/TopBar.tsx`, `components/RightDrawer.tsx`, `App.tsx` (layout shell) | LeftNav collapsible (icon-only mode). TopBar inside content column. RightDrawer conditional overlay. | `frontend/tests/layout.spec.tsx` |
| **FR-018** | **FE:** `App.tsx` (global keydown handler) | Cmd+K toggles command palette. Escape closes command palette then CreateTaskModal. | `frontend/tests/keyboard.spec.tsx` |
| **FR-019** | **FE:** `types.ts` (Workout), `views/Workouts.tsx` (exists, not imported), `constants.ts` (MOCK_WORKOUTS), `services/dataService.ts` (getWorkouts) | Placeholder "Coming Soon" rendered inline in App.tsx. View file and mock data exist. Module default OFF in feature flags. | `frontend/tests/workouts.spec.tsx`, `backend/tests/workouts.rs` |
| **FR-020** | **Arch:** `docs/technical_architecture/001_architecture.md` | Phase 0 uses in-memory mocks. Architecture doc defines vault + SQLCipher + EAV model for local-first storage. | `backend/tests/vault.rs`, `backend/tests/storage.rs` |
| **FR-021** | **Arch:** `docs/technical_architecture/004_AI_INTEGRATION.md` (Section 7: PII Shield) | Not yet implemented. Planned for Phase 4 Rust backend (`cortex_ai` crate). | `backend/tests/pii_shield.rs` |
| **FR-022** | **Arch:** `docs/technical_architecture/004_AI_INTEGRATION.md` (Section 9: Morning Review) | Not yet implemented. Planned for Phase 4. Review queue in SQLCipher. | `backend/tests/morning_review.rs` |
| **FR-023** | **FE:** `services/dataService.ts` (searchGlobal) | Phase 0: naive text match. Backend will implement FTS5 + sqlite-vec hybrid search. | `frontend/tests/search.spec.tsx`, `backend/tests/search.rs` |
| **FR-024** | **FE:** `services/aiService.ts` (transcribeAudio, generateSpeech), `types.ts` (AISettings voice fields). **ADR:** ADR-0004 | Gemini-based transcription and TTS. Configurable voice (5 options). Phase 0 frontend-direct. Not in original vision. | `frontend/tests/voice.spec.tsx`, `backend/tests/ai_voice.rs` |
| **FR-025** | **FE:** `services/dataService.ts` (saveQuickCapture), `views/TodayDashboard.tsx` | Appends text to `Quick Capture/{date}.md` in mock filesystem. Accessible from Today Dashboard. | `frontend/tests/quick_capture.spec.tsx` |
| **FR-026** | **FE:** `types.ts` (ScheduleItem — defined in dataService.ts), `services/dataService.ts` (getTodaySchedule, addToSchedule), `views/TodayDashboard.tsx` | Time-blocked items with start time and duration. Tasks can be added to schedule. | `frontend/tests/schedule.spec.tsx`, `backend/tests/calendar.rs` |

### How to read this matrix

- **FE:** = `cortex-os-frontend` repository
- **BE:** = `cortex-os-backend` repository (not yet implemented for most FRs)
- **Arch:** = Architecture design documents (implementation planned)
- **Test Location (planned):** Suggested test file paths. These tests do not exist yet.
- When adding or modifying a requirement, update this matrix and link the new code.
